<!DOCTYPE html>
<html lang="en-US" dir="LTR" class="Public NoJs LoggedOut NoSidebar Responsive">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <base href="" />
    <title>Oxide - Broadcast admin voice server wide?</title>
    <noscript>
        <style>
            .JsOnly,
            .jsOnly {
                display: none !important;
            }
        </style>
    </noscript>
    <script src="/assets/js/jquery/jquery-1.11.0.min.js"></script>
    <script src="/assets/js/xenforo/xenforo.js?_v=f33b43a2"></script>
    <link rel="canonical" href="" />
    <link rel="stylesheet" href="/assets/default.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" />
    <link rel="icon" sizes="196x196" href="/assets/styles/oxide/logo.og.png" />
    <link rel="apple-touch-icon" href="/assets/styles/oxide/logo.og.png" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="description" content="Oxide is an abstracted, modular, and extensible mod and plugin framework for any game that uses .NET" />
    <meta property="og:site_name" content="Oxide" />
    <meta property="og:image" content="/assets/styles/oxide/logo.og.png" />
    <meta property="og:url" content="" />
    <meta property="og:title" content="Oxide - Broadcast admin voice server wide?" />
    <meta property="og:description" content="" />
</head>
<body>
    <div id="headerMover">
        <div id="headerProxy"></div>
        <div id="content" class="forum_list">
            <div class="pageWidth">
                <div class="pageContent">
                    <div class="breadBoxTop">
    <nav>
        <fieldset class="breadcrumb">
            <div class="boardTitle"><strong>Oxide</strong></div>
            <span class="crumbs">
                <span class="crust">
                    <a href="/" class="crumb" rel="up" itemprop="url">
                        <span itemprop="title">Forums</span>
                    </a>
                    <span class="arrow"></span>
                </span>
                
                    
                    <span class="crust">
                        <a href="/forums/plugin-development.105/" class="crumb" rel="up" itemprop="url">
                            <span itemprop="title">Plugin Development</span>
                        </a>
                        <span class="arrow"></span>
                    </span>
                    
                
                    
                    <span class="crust">
                        <a href="/forums/rust-development.4/" class="crumb" rel="up" itemprop="url">
                            <span itemprop="title">Rust Development</span>
                        </a>
                        <span class="arrow"></span>
                    </span>
                    
                
            </span>
        </fieldset>
    </nav>
</div>

<div class="titleBar">
    <h1>
        <a href="/threads/broadcast-admin-voice-server-wide.24587/">Broadcast admin voice server wide?</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="/forums/rust-development.4/">Rust Development</a>' started by <a class="username"
            dir="auto">Brohawk</a>, <a href="/threads/broadcast-admin-voice-server-wide.24587/"><span class="DateTime" title="Mar 21, 2017 at 10:09 PM">Mar 21,
                2017</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-309558" class="message" data-author="Brohawk">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Brohawk" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Brohawk</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Is thier any way at all a mod can be made to let admin broadcast voice SERVERWIDE so everyone hears admin <div
                            class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Brohawk</a>,</span>
                        <a href="/threads/broadcast-admin-voice-server-wide.24587/" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 21, 2017 at 10:09 PM">Mar 21, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/broadcast-admin-voice-server-wide.24587/" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/309558/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-309559" class="message" data-author="Kappasaurus">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Kappasaurus" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Kappasaurus</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">No, Rust voice chat is P2P. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Kappasaurus</a>,</span>
                        <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309559" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 21, 2017 at 10:12 PM">Mar 21, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309559" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/309559/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-309568" class="message" data-author="DogManJr">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="DogManJr" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">DogManJr</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Okay, so I tried doing some research.<br /> In my decompiled Assembly-CSharp.dll, I found in BaseNetworkable the
                        following:<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>private void LinkToNeighbours ()
    {
        if (this.links.Count == 0) {
            return;
        }
        this.linkedToNeighbours = true;
        using (TimeWarning.New (&quot;LinkToNeighbours&quot;, 0.1)) {
            List&lt;BaseEntity&gt; list = Pool.GetList&lt;BaseEntity&gt; ();
            OBB oBB = this.WorldSpaceBounds ();
            Vis.Entities&lt;BaseEntity&gt; (oBB.position, oBB.extents.get_magnitude () + 1, list, -1, 2);
            for (int i = 0; i &lt; list.Count; i++) {
                this.LinkToEntity (list [i]);
            }
            Pool.FreeList&lt;BaseEntity&gt; (ref list);
        }
    }</pre>
                        </div>As you may notice, &quot;linking to neighbors&quot; is done by proximity.<br /> I have a slight suspicion that linked neighbors are the ones that receive your voice
                        signal.<br /> However, there is also this method:<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>public void RefreshEntityLinks ()
    {
        for (int i = 0; i &lt; this.links.Count; i++) {
            this.links [i].Clear ();
        }
        this.LinkToNeighbours ();
    }</pre>
                        </div>Which seems like it is called regularly in order to update which players are close to each player.<br /> The good news is that it is public, and that it is a superclass
                        of BasePlayer, so you can override the method.<br /> The bad news is that it is not virtual, and so before overriding the method, you should find out what other functionality
                        depends on this method, since it was not meant to be overridden.<br /> Disclaimer: I am not even sure if &quot;linked entities&quot; even is what defines who can hear who in
                        the game, but it is a place to start.<br />
                        <br /> Good luck <img src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie1" alt=":)" title="Smile    :)" />
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">DogManJr</a>,</span>
                        <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309568" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 21, 2017 at 11:32 PM">Mar 21, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309568" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/309568/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-309569" class="message" data-author="sqroot">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="sqroot" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">sqroot</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Overriding won&#039;t help here (or in fact almost anywhere) because you usually do not have access to the code
                        that adds polymorphic types to any kind of handler either. <br /> Going down that chain you&#039;d probably end up at some static method where overriding won&#039;t help you
                        anymore.<br /> Oxide would have to inject code to make this happen, although I don&#039;t think this is necessarily a good idea. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">sqroot</a>,</span>
                        <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309569" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 22, 2017 at 12:01 AM">Mar 22, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309569" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/309569/permalink">#4</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-309572" class="message" data-author="DogManJr">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="DogManJr" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">DogManJr</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Makes sense, I&#039;m annoyed I didn&#039;t realize that lol.<br /> However, do you think the following could
                        work? (albeit very hacky)<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>
//BasePlayer garry;
foreach (BasePlayer bp in theServer) {
    if (garry != bp) {
        garry.LinkToEntity (bp);
    }
}
</pre>
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">DogManJr</a>,</span>
                        <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309572" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 22, 2017 at 12:07 AM">Mar 22, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309572" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/309572/permalink">#5</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-309574" class="message" data-author="sqroot">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="sqroot" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">sqroot</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="DogManJr">
                            <aside>
                                <div class="attribution type">DogManJr said: <a href="#post-309572" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Makes sense, I&#039;m annoyed I didn&#039;t realize that lol.<br /> However, do you think the following could work? (albeit very hacky)<br />
                                        <div class="bbCodeBlock bbCodeCode">
                                            <div class="type">Code:</div>
                                            <pre>
//BasePlayer garry;
foreach (BasePlayer bp in theServer) {
    if (garry != bp) {
        garry.LinkToEntity (bp);
    }
}
</pre>
                                        </div>
                                    </div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Depends on whether LinkToEntity affects anything other than voice chat (or voice chat at all) and when Rust updates the entity link.<br /> I cannot check right now
                        because I don&#039;t have a server installed, though. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">sqroot</a>,</span>
                        <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309574" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 22, 2017 at 12:19 AM">Mar 22, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309574" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/309574/permalink">#6</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-309585" class="message" data-author="Mughisi">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Mughisi" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Mughisi</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">The code fragments mentioned have nothing to do with the voice chat, the EntityLink code mentioned is used to link
                        buildingblocks and such to eachother by using their male/female sockets. <br /> All the voice chat related code is only available in the client and is P2P, and is part of the
                        PlayerVoiceRecorder class.<br />
                        <br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>    public void P2PBroadcast(float radius, P2PMessages.Type type, byte[] data, bool includeSelf = true)
    {
        if (data == null)
        {
            return;
        }
        if ((int)data.Length &lt;= 0)
        {
            return;
        }
        Vector3 vector3 = base.transform.position;
        using (MemoryStream memoryStream = new MemoryStream((int)data.Length + 1))
        {
            using (BinaryWriter binaryWriter = new BinaryWriter(memoryStream))
            {
                binaryWriter.Write((byte)type);
                binaryWriter.Write(data);
                foreach (BasePlayer basePlayer in BasePlayer.visiblePlayerList)
                {
                    if (basePlayer != this)
                    {
                        if (basePlayer != null)
                        {
                            if (Vector3.Distance(vector3, basePlayer.transform.position) &lt;= radius)
                            {
                                if (basePlayer.userID != 0)
                                {
                                    if (basePlayer.IsConnected)
                                    {
                                        Client.Steam.Networking.SendP2PPacket(basePlayer.userID, memoryStream.GetBuffer(), (int)memoryStream.Length, Networking.SendType.UnreliableNoDelay, 0);
                                    }
                                }
                            }
                        }
                    }
                }
                if (includeSelf)
                {
                    Client.Steam.Networking.SendP2PPacket(Client.Steam.SteamId, memoryStream.GetBuffer(), (int)memoryStream.Length, Networking.SendType.UnreliableNoDelay, 0);
                }
            }
        }
    }    public void P2PMessage(P2PMessages.Type type, BinaryReader data)
    {
        P2PMessages.Type type1 = type;
        if (type1 == P2PMessages.Type.VOICE)
        {
            this.voiceSpeaker.Receive(data);
        }
        else if (type1 == P2PMessages.Type.TICK)
        {
        }
    }</pre>
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
                        <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309585" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 22, 2017 at 12:48 AM">Mar 22, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/broadcast-admin-voice-server-wide.24587/#post-309585" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/309585/permalink">#7</a>
                </div>
            </div>
        </div>
    </li>
</ol>


                    <footer>
                        <div class="footer">
                            <div class="pageContent"></div>
                            <div id="copyright"><span class="concealed">Built: Wed, 27 Mar 2019 21:25:21 -0400</span></div>
                            <span class="helper"></span>
                            <ul class="footerLinks">
                                <li><a href="/terms/">Terms and Rules</a></li>
                                <li><a href="https://umod.org/community" target="_blank">Contact Us</a></li>
                            </ul>
                            <span class="helper"></span>
                        </div>
                    </footer>
                </div>
            </div>
        </div>
        <header>
            <div id="header">
                <div class="headerWidth">
                    <div id="logoBlock">
                        <div id="logo"><a href="/">
                                <span></span>
                                <img src="/assets/styles/oxide/logo.png" alt="Oxide" />
                            </a></div>
                        <span class="helper"></span>
                    </div>
                    <div id="navigation" class="">
                        <div class="pageContent">
                            <nav>
                                <div class="navTabs">
                                    <ul class="publicTabs">
                                        <li class="navTab forums Popup PopupControl PopupClosed PopupContainerControl">
                                            <a href="/" class="navLink" rel="Menu">Forums</a>
                                        </li>
                                        <li class="navTab PopupClosed">
                                            <a href="https://umod.org/documentation" class="navLink">Docs</a>
                                        </li>
                                        <li class="navTab Popup PopupControl PopupClosed PopupContainerControl">
                                            <a href="/downloads/" class="navLink" rel="Menu">Downloads</a>
                                        </li>
                                        <li class="navTab Popup PopupControl PopupClosed PopupContainerControl">
                                            <a href="/plugins/" class="navLink" rel="Menu">Plugins</a>
                                        </li>
                                        <li class="navTab selected">
                                            <div class="tabLinks"></div>
                                        </li>
                                    </ul>
                                </div>
                                <span class="helper"></span>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </header>
    </div>
    <script>
        jQuery.extend(true, XenForo, {
            visitor: {
                user_id: 0
            },
            serverTimeInfo: {
                now: 1548531785,
                today: 1548460800,
                todayDow: 6
            },
            _lightBoxUniversal: "0",
            _enableOverlays: "1",
            _animationSpeedMultiplier: "1",
            _overlayConfig: {
                top: "10%",
                speed: 200,
                closeSpeed: 100,
                mask: {
                    color: "rgb(255, 255, 255)",
                    opacity: "0.6",
                    loadSpeed: 200,
                    closeSpeed: 100
                }
            },
            _ignoredUsers: [],
            _loadedScripts: {
                "node_list": true,
                "node_category": true,
                "node_forum": true,
                "discussion_list": true,
                "wf_default": true
            },
            _cookieConfig: {
                path: "/",
                domain: ".oxidemod.org",
                prefix: "xfid_"
            },
            _jsVersion: "f33b43a2"
        });
        jQuery.extend(XenForo.phrases, {
            cancel: "Cancel",
            a_moment_ago: "A moment ago",
            one_minute_ago: "1 minute ago",
            x_minutes_ago: "%minutes% minutes ago",
            today_at_x: "Today at %time%",
            yesterday_at_x: "Yesterday at %time%",
            day_x_at_time_y: "%day% at %time%",
            day0: "Sunday",
            day1: "Monday",
            day2: "Tuesday",
            day3: "Wednesday",
            day4: "Thursday",
            day5: "Friday",
            day6: "Saturday",
            _months: "January,February,March,April,May,June,July,August,September,October,November,December",
            _daysShort: "Sun,Mon,Tue,Wed,Thu,Fri,Sat",
            following_error_occurred: "The following error occurred",
            server_did_not_respond_in_time_try_again: "The server did not respond in time. Please try again.",
            logging_in: "Logging in",
            click_image_show_full_size_version: "Click this image to show the full-size version.",
            show_hidden_content_by_x: "Show hidden content by {names}"
        });
    </script>
</body>
</html>
