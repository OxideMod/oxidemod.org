<!DOCTYPE html>
<html lang="en-US" dir="LTR" class="Public NoJs LoggedOut NoSidebar Responsive">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <base href="" />
    <title>Oxide - Solved - Detecting when helicopter despawns/retires?</title>
    <noscript>
        <style>
            .JsOnly,
            .jsOnly {
                display: none !important;
            }
        </style>
    </noscript>
    <script src="/assets/js/jquery/jquery-1.11.0.min.js"></script>
    <script src="/assets/js/xenforo/xenforo.js?_v=f33b43a2"></script>
    <link rel="canonical" href="" />
    <link rel="stylesheet" href="/assets/default.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" />
    <link rel="icon" sizes="196x196" href="/assets/styles/oxide/logo.og.png" />
    <link rel="apple-touch-icon" href="/assets/styles/oxide/logo.og.png" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="description" content="Oxide is an abstracted, modular, and extensible mod and plugin framework for any game that uses .NET" />
    <meta property="og:site_name" content="Oxide" />
    <meta property="og:image" content="/assets/styles/oxide/logo.og.png" />
    <meta property="og:url" content="" />
    <meta property="og:title" content="Oxide - Solved - Detecting when helicopter despawns/retires?" />
    <meta property="og:description" content="" />
</head>
<body>
    <div id="headerMover">
        <div id="headerProxy"></div>
        <div id="content" class="forum_list">
            <div class="pageWidth">
                <div class="pageContent">
                    <div class="breadBoxTop">
    <nav>
        <fieldset class="breadcrumb">
            <div class="boardTitle"><strong>Oxide</strong></div>
            <span class="crumbs">
                <span class="crust">
                    <a href="/" class="crumb" rel="up" itemprop="url">
                        <span itemprop="title">Forums</span>
                    </a>
                    <span class="arrow"></span>
                </span>
                
                    
                    <span class="crust">
                        <a href="/forums/plugin-development.105/" class="crumb" rel="up" itemprop="url">
                            <span itemprop="title">Plugin Development</span>
                        </a>
                        <span class="arrow"></span>
                    </span>
                    
                
                    
                    <span class="crust">
                        <a href="/forums/rust-development.4/" class="crumb" rel="up" itemprop="url">
                            <span itemprop="title">Rust Development</span>
                        </a>
                        <span class="arrow"></span>
                    </span>
                    
                
            </span>
        </fieldset>
    </nav>
</div>

<div class="titleBar">
    <h1>
        <span class="prefix prefixGreen">Solved</span> <a href="/threads/detecting-when-helicopter-despawns-retires.24399/">Detecting when helicopter
            despawns/retires?</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="/forums/rust-development.4/">Rust Development</a>' started by <a class="username"
            dir="auto">JoeSheep</a>, <a href="/threads/detecting-when-helicopter-despawns-retires.24399/"><span class="DateTime" title="Mar 11, 2017 at 7:56 PM">Mar 11,
                2017</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-306798" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Hi!<br />
                        <br /> I am looking to get when a helicopter has despawned or &quot;retired&quot; when leaving the map so I can send information to console or a player.<br />
                        <br /> So far I cannot figure anything out from looking at Assembly-CSharp. Any ideas?<br />
                        <br />
                        <br /> Cheers! <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate">Last edited by a moderator: <span class="DateTime" title="Mar 11, 2017 at 9:04 PM">Mar 11, 2017</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 7:56 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/306798/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306817" class="message" data-author="Zhahaman2001">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Zhahaman2001" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Zhahaman2001</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>        private void OnEntityDeath(BaseCombatEntity entity, HitInfo info)
        {
            if (entity is BaseHelicopter)
            {
                Puts(&quot;Heli death msg to console&quot;);
                rust.BroadcastChat(&quot;Heli death msg to players&quot;);
            }
        }</pre>
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Zhahaman2001</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306817" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 8:50 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306817" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306817/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306826" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Zhahaman2001">
                            <aside>
                                <div class="attribution type">Zhahaman2001 said: <a href="#post-306817" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">
                                        <div class="bbCodeBlock bbCodeCode">
                                            <div class="type">Code:</div>
                                            <pre>        private void OnEntityDeath(BaseCombatEntity entity, HitInfo info)
        {
            if (entity is BaseHelicopter)
            {
                Puts(&quot;Heli death msg to console&quot;);
                rust.BroadcastChat(&quot;Heli death msg to players&quot;);
            }
        }</pre>
                                        </div>
                                    </div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div><br /> Unfortunately with the way the helicopter is disposed of it doesn&#039;t trigger that hook:<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>
  public void Retire()
  {
    if (this.isRetiring)
      return;
    this.isRetiring = true;
    this.Invoke(&quot;DestroyMe&quot;, 240f);
    float num1 = TerrainMeta.Size.x;
    float num2 = 200f;
    Vector3 newPos = Vector3Ex.Range(-1f, 1f);
    newPos.y = 0.0f;
    newPos.Normalize();
    newPos *= num1 * 20f;
    newPos.y = num2;
    this.ExitCurrentState();
    this.State_Move_Enter(newPos);
  }  public void DestroyMe()
  {
    this.helicopterBase.Kill(BaseNetworkable.DestroyMode.None);
  }
</pre>
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306826" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 9:02 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306826" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306826/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306829" class="message" data-author="Zhahaman2001">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Zhahaman2001" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Zhahaman2001</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Yes it does, it just takes awhile. It takes about 2 to 5 mins for it to despawn after it starts flying away. <div
                            class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Zhahaman2001</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306829" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 9:06 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306829" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306829/permalink">#4</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306839" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Zhahaman2001">
                            <aside>
                                <div class="attribution type">Zhahaman2001 said: <a href="#post-306829" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Yes it does, it just takes awhile. It takes about 2 to 5 mins for it to despawn after it starts flying away.</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>My plugin contains the code:<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>        void OnEntityDeath(BaseCombatEntity entity, HitInfo info)
        {
            if (helicopterDestroyedAnnouncement &amp;&amp; entity is BaseHelicopter)
            {
                if (helicopterDestroyedAnnouncementWithDestroyer)
                {
                    CreateAnnouncement(helicopterDestroyedAnnouncementWithDestroyerText.Replace(&quot;{playername}&quot;, LastHitPlayer), BannerTintRed, TextWhite);
                    LastHitPlayer = String.Empty;
                }
                else
                {
                    CreateAnnouncement(helicopterDestroyedAnnouncementText, BannerTintRed, TextWhite);
                }
                ....
            }
        }
</pre>
                        </div>And it does not do anything when the helicopter is destroyed the way that the aforementioned DestroyMe() method does. Same with the plugin DeathNotes. <div
                            class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate">Last edited by a moderator: <span class="DateTime" title="Mar 11, 2017 at 9:47 PM">Mar 11, 2017</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306839" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 9:34 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306839" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306839/permalink">#5</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306849" class="message" data-author="Zhahaman2001">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Zhahaman2001" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Zhahaman2001</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Hey I am really sorry, you are absolutely right. I just graded some code out of the heli plugin I wrote awhile ago
                        and didn&#039;t remember I ran into the same problem. Looks like my work around was to store the heli BaseHelicopter into a var and check the var with a timer every second
                        until it equals null. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Zhahaman2001</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306849" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 9:58 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306849" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306849/permalink">#6</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306854" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Zhahaman2001">
                            <aside>
                                <div class="attribution type">Zhahaman2001 said: <a href="#post-306849" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Hey I am really sorry, you are absolutely right. I just graded some code out of the heli plugin I wrote awhile ago and didn&#039;t remember I ran
                                        into the same problem. Looks like my work around was to store the heli BaseHelicopter into a var and check the var with a timer every second until it equals
                                        null.</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>That&#039;s an idea definitely.<br /> I was just looking at InfoPanel and it seems to do it a rather complicated way with extra classes and events. I don&#039;t
                        understand yet exactly how it works, so I can&#039;t tell which way would be the most efficient yet (in terms of performance). <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306854" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 10:03 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306854" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306854/permalink">#7</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306862" class="message" data-author="Zhahaman2001">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Zhahaman2001" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Zhahaman2001</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">My plugin already has to have the one second timer so it was a ok solution for me. There probably is a more
                        efficient way, you should post what you find. <img src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie1" alt=":)" title="Smile    :)" />
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Zhahaman2001</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306862" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 10:13 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306862" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306862/permalink">#8</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306872" class="message" data-author="ignignokt84">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="ignignokt84" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ignignokt84</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Couldn&#039;t you use <i>OnEntityKill</i>? <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ignignokt84</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306872" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 10:34 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306872" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306872/permalink">#9</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306894" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="ignignokt84">
                            <aside>
                                <div class="attribution type">ignignokt84 said: <a href="#post-306872" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Couldn&#039;t you use <i>OnEntityKill</i>?</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>I wasn&#039;t aware of that hook.<br />
                        <br /> EDIT: Yep just looked through the Oxide Git repo and found that. Worth testing. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306894" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 10:58 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306894" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306894/permalink">#10</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306897" class="message" data-author="ignignokt84">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="ignignokt84" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ignignokt84</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">It&#039;s not in the docs (they&#039;re out of date), but it gets called when a BaseNetworkable has Kill called.
                        It should work for both heli being shot down and heli despawning <img src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie1" alt=":)"
                            title="Smile    :)" /><br /> [DOUBLEPOST=1489273324][/DOUBLEPOST] <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>void OnEntityKill(BaseNetworkable entity)
{
  if (entity is BaseHelicopter)
    Puts(&quot;Heli is gone :(&quot;);
}</pre>
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ignignokt84</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306897" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 11:00 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306897" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306897/permalink">#11</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-306906" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="ignignokt84">
                            <aside>
                                <div class="attribution type">ignignokt84 said: <a href="#post-306897" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">It&#039;s not in the docs (they&#039;re out of date), but it gets called when a BaseNetworkable has Kill called. It should work for both heli
                                        being shot down and heli despawning <img src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie1" alt=":)" title="Smile    :)" /><br />
                                        [DOUBLEPOST=1489273324][/DOUBLEPOST] <div class="bbCodeBlock bbCodeCode">
                                            <div class="type">Code:</div>
                                            <pre>void OnEntityKill(BaseNetworkable entity)
{
  if (entity is BaseHelicopter)
    Puts(&quot;Heli is gone :(&quot;);
}</pre>
                                        </div>
                                    </div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Since I have code for it being shot down and despawning, I will have to figure out a way to tell the difference between the two for the correct text to be sent.<br />
                        <br /> EDIT: I can&#039;t think of anything... Maybe a timer from the last time it was damaged? If it despawns and wasn&#039;t damaged after say one minute we can safely assume
                        it retired? Unless you use HeliControl to make it keep targeting you even when it is supposed to be leaving, that way it can just despawn in front of you. Concerned of the
                        performance of constantly destroying and recreating a timer everytime the helicopter takes damage. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate">Last edited by a moderator: <span class="DateTime" title="Mar 12, 2017 at 12:48 AM">Mar 12, 2017</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306906" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 11, 2017 at 11:22 PM">Mar 11, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-306906" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/306906/permalink">#12</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-307005" class="message" data-author="Shady757">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Shady757" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Shady757</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="JoeSheep">
                            <aside>
                                <div class="attribution type">JoeSheep said: <a href="#post-306906" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Since I have code for it being shot down and despawning, I will have to figure out a way to tell the difference between the two for the correct
                                        text to be sent.<br />
                                        <br /> EDIT: I can&#039;t think of anything... Maybe a timer from the last time it was damaged? If it despawns and wasn&#039;t damaged after say one minute we
                                        can safely assume it retired? Unless you use HeliControl to make it keep targeting you even when it is supposed to be leaving, that way it can just despawn in
                                        front of you. Concerned of the performance of constantly destroying and recreating a timer everytime the helicopter takes damage.</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>If OnEntityKill is the despawning code and OnEntityDeath is the shot down code, don&#039;t you already have your solution? <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Shady757</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307005" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 12, 2017 at 8:53 AM">Mar 12, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307005" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/307005/permalink">#13</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-307043" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Shady757">
                            <aside>
                                <div class="attribution type">Shady757 said: <a href="#post-307005" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">If OnEntityKill is the despawning code and OnEntityDeath is the shot down code, don&#039;t you already have your solution?</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>I hadn&#039;t tested anything yet, so I was going by what ignignokt84 said it doing both instead of just for despawning. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307043" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 12, 2017 at 12:27 PM">Mar 12, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307043" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/307043/permalink">#14</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-307184" class="message" data-author="ignignokt84">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="ignignokt84" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ignignokt84</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">I was just being factual <img src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie1" alt=":)"
                            title="Smile    :)" /> OnEntityKill does get called for both, but is not necessarily the best to use for both events. Like Shady said, you could use OnEntityDeath to handle
                        shot down, then you could just grab the net ID, toss it in a list, and ignore it on OnEntityKill... But there are always alternatives <img
                            src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie2" alt=";)" title="Wink    ;)" />
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ignignokt84</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307184" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 12, 2017 at 8:36 PM">Mar 12, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307184" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/307184/permalink">#15</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-307197" class="message" data-author="Shady757">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="Shady757" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Shady757</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="JoeSheep">
                            <aside>
                                <div class="attribution type">JoeSheep said: <a href="#post-307043" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">I hadn&#039;t tested anything yet, so I was going by what ignignokt84 said it doing both instead of just for despawning.</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Woops, I didn&#039;t read the part where it said it&#039;s called for both types of deaths. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Shady757</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307197" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 12, 2017 at 8:58 PM">Mar 12, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307197" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/307197/permalink">#16</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-307470" class="message" data-author="JoeSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="/assets/styles/oxide/logo.og.png" width="96" height="96" alt="JoeSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">JoeSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">I just tested it, I had both OnEntityDeath and OnEntityKill checking if the entity is BaseHelicopter then output
                        to console when that method gets called. I shot down a helicopter and only OnEntityDeath was called. I let one despawn and only OnEntityKill gets called. But on the odd
                        occasion probably due to processing time I get both. So ignoring the entity ID in OnEntityKill with a timer delay could work before checking.<br />
                        <br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            <pre>        private List&lt;uint&gt; HeliNetIDs = new List&lt;uint&gt;();        void OnEntityDeath(BaseCombatEntity entity, HitInfo info)
        {
            if (helicopterDestroyedAnnouncement &amp;&amp; entity is BaseHelicopter)
            {
                var entityNetID = entity.net.ID;
                if (helicopterDespawnAnnouncement)
                    HeliNetIDs.Add(entityNetID);
                if (helicopterDestroyedAnnouncementWithDestroyer)
                {
                    CreateAnnouncement(helicopterDestroyedAnnouncementWithDestroyerText.Replace(&quot;{playername}&quot;, LastHitPlayer), helicopterDestroyedAnnouncementBannerColor, helicopterDestroyedAnnouncementTextColor);
                    LastHitPlayer = String.Empty;
                }
                else
                {
                    CreateAnnouncement(helicopterDestroyedAnnouncementText, helicopterDestroyedAnnouncementBannerColor, helicopterDestroyedAnnouncementTextColor);
                }
            }
        }        void OnEntityKill(BaseNetworkable entity)
        {
            if (entity is BaseHelicopter)
            {
                var entityNetID = entity.net.ID;
                timer.Once(2, () =&gt;
                {
                    if (HeliNetIDs.Contains(entityNetID))
                        HeliNetIDs.Remove(entityNetID);
                    else if (helicopterDespawnAnnouncement)
                        CreateAnnouncement(helicopterDespawnAnnouncementText, helicopterDespawnAnnouncementBannerColor, helicopterDespawnAnnouncementTextColor);
                });
            }
        }
</pre>
                        </div>That seems to do the job. I did notice however that I cannot use entity.net.ID in OnEntityKill all the way through the timer, as it produces an NRE, so it would seem that
                        throwing the ID into a variable asap is necessary. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate">Last edited by a moderator: <span class="DateTime" title="Mar 13, 2017 at 4:04 PM">Mar 13, 2017</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">JoeSheep</a>,</span>
                        <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307470" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 13, 2017 at 3:18 PM">Mar 13, 2017</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="/threads/detecting-when-helicopter-despawns-retires.24399/#post-307470" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/307470/permalink">#17</a>
                </div>
            </div>
        </div>
    </li>
</ol>


                    <footer>
                        <div class="footer">
                            <div class="pageContent"></div>
                            <div id="copyright"><span class="concealed">Built: Wed, 27 Mar 2019 21:25:21 -0400</span></div>
                            <span class="helper"></span>
                            <ul class="footerLinks">
                                <li><a href="/terms/">Terms and Rules</a></li>
                                <li><a href="https://umod.org/community" target="_blank">Contact Us</a></li>
                            </ul>
                            <span class="helper"></span>
                        </div>
                    </footer>
                </div>
            </div>
        </div>
        <header>
            <div id="header">
                <div class="headerWidth">
                    <div id="logoBlock">
                        <div id="logo"><a href="/">
                                <span></span>
                                <img src="/assets/styles/oxide/logo.png" alt="Oxide" />
                            </a></div>
                        <span class="helper"></span>
                    </div>
                    <div id="navigation" class="">
                        <div class="pageContent">
                            <nav>
                                <div class="navTabs">
                                    <ul class="publicTabs">
                                        <li class="navTab forums Popup PopupControl PopupClosed PopupContainerControl">
                                            <a href="/" class="navLink" rel="Menu">Forums</a>
                                        </li>
                                        <li class="navTab PopupClosed">
                                            <a href="https://umod.org/documentation" class="navLink">Docs</a>
                                        </li>
                                        <li class="navTab Popup PopupControl PopupClosed PopupContainerControl">
                                            <a href="/downloads/" class="navLink" rel="Menu">Downloads</a>
                                        </li>
                                        <li class="navTab Popup PopupControl PopupClosed PopupContainerControl">
                                            <a href="/plugins/" class="navLink" rel="Menu">Plugins</a>
                                        </li>
                                        <li class="navTab selected">
                                            <div class="tabLinks"></div>
                                        </li>
                                    </ul>
                                </div>
                                <span class="helper"></span>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </header>
    </div>
    <script>
        jQuery.extend(true, XenForo, {
            visitor: {
                user_id: 0
            },
            serverTimeInfo: {
                now: 1548531785,
                today: 1548460800,
                todayDow: 6
            },
            _lightBoxUniversal: "0",
            _enableOverlays: "1",
            _animationSpeedMultiplier: "1",
            _overlayConfig: {
                top: "10%",
                speed: 200,
                closeSpeed: 100,
                mask: {
                    color: "rgb(255, 255, 255)",
                    opacity: "0.6",
                    loadSpeed: 200,
                    closeSpeed: 100
                }
            },
            _ignoredUsers: [],
            _loadedScripts: {
                "node_list": true,
                "node_category": true,
                "node_forum": true,
                "discussion_list": true,
                "wf_default": true
            },
            _cookieConfig: {
                path: "/",
                domain: ".oxidemod.org",
                prefix: "xfid_"
            },
            _jsVersion: "f33b43a2"
        });
        jQuery.extend(XenForo.phrases, {
            cancel: "Cancel",
            a_moment_ago: "A moment ago",
            one_minute_ago: "1 minute ago",
            x_minutes_ago: "%minutes% minutes ago",
            today_at_x: "Today at %time%",
            yesterday_at_x: "Yesterday at %time%",
            day_x_at_time_y: "%day% at %time%",
            day0: "Sunday",
            day1: "Monday",
            day2: "Tuesday",
            day3: "Wednesday",
            day4: "Thursday",
            day5: "Friday",
            day6: "Saturday",
            _months: "January,February,March,April,May,June,July,August,September,October,November,December",
            _daysShort: "Sun,Mon,Tue,Wed,Thu,Fri,Sat",
            following_error_occurred: "The following error occurred",
            server_did_not_respond_in_time_try_again: "The server did not respond in time. Please try again.",
            logging_in: "Logging in",
            click_image_show_full_size_version: "Click this image to show the full-size version.",
            show_hidden_content_by_x: "Show hidden content by {names}"
        });
    </script>
</body>
</html>
