<!DOCTYPE html>
<html id="XenForo" lang="en-US" dir="LTR" class="Public NoJs LoggedOut NoSidebar  Responsive" xmlns:fb="http://www.facebook.com/2008/fbml">
<head>

	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
	
		<meta name="viewport" content="width=device-width, initial-scale=1" />
	
	
		<base href="https://oxidemod.org/" />
		<script>
			var _b = document.getElementsByTagName('base')[0], _bH = "https://oxidemod.org/";
			if (_b && _b.href != _bH) _b.href = _bH;
		</script>
	

	<title>Solved - Make players sleep? (Lua) | Page 2 | Oxide</title>
	
	<noscript><style>.JsOnly, .jsOnly { display: none !important; }</style></noscript>
	<link rel="stylesheet" href="css.php?css=xenforo,form,public&amp;style=5&amp;dir=LTR&amp;d=1548526345" />
	<link rel="stylesheet" href="css.php?css=bb_code,message,message_user_info,thread_view&amp;style=5&amp;dir=LTR&amp;d=1548526345" />
	
	

	
		<script src="js/jquery/jquery-1.11.0.min.js"></script>	
		
	<script src="js/xenforo/xenforo.js?_v=f33b43a2"></script>

	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
	<meta name="mobile-web-app-capable" content="yes" />
<link rel="icon" sizes="196x196" href="https://oxidemod.org/styles/oxide/logo.og.png" />
<link rel="apple-touch-icon" href="https://oxidemod.org/styles/oxide/logo.og.png" />
	<link rel="alternate" type="application/rss+xml" title="RSS feed for Oxide" href="forums/-/index.rss" />
		
	<link rel="prev" href="threads/make-players-sleep-lua.7435/" />
	<link rel="canonical" href="https://oxidemod.org/threads/make-players-sleep-lua.7435/page-2" />
	<meta name="description" content="okay, can also be my bad when writing it ^^
Thanks
Cant I use rust.SendChatMessage
for that You are now AFK and stuff?
Also where can i add this You..." />	<meta property="og:site_name" content="Oxide" />
	<meta property="og:image" content="https://oxidemod.org/styles/default/xenforo/avatars/avatar_m.png" />
	<meta property="og:image" content="https://oxidemod.org/styles/oxide/logo.og.png" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://oxidemod.org/threads/make-players-sleep-lua.7435/" />
	<meta property="og:title" content="Solved - Make players sleep? (Lua)" />
	<meta property="og:description" content="okay, can also be my bad when writing it ^^
Thanks
Cant I use rust.SendChatMessage
for that You are now AFK and stuff?
Also where can i add this You..." />
	
	
	

</head>

<body class="node4 node1 node104 node105 SelectQuotable">




<div id="headerMover">
	<div id="headerProxy"></div>

<div id="content" class="thread_view">
	<div class="pageWidth">
		<div class="pageContent">
			
			
			

			

			
			
				<div class="breadBoxTop ">
					
					

<nav>
	
		
			
				
			
		
			
				
			
		
			
				
			
		
			
				
			
		
	

	<fieldset class="breadcrumb">			
		<div class="boardTitle"><strong>Oxide</strong></div>
		
		<span class="crumbs">
			
				

					
						<span class="crust selectedTabCrumb" itemscope="itemscope" itemtype="http://data-vocabulary.org/Breadcrumb">
							<a href="https://oxidemod.org/" class="crumb" rel="up" itemprop="url"><span itemprop="title">Forums</span></a>
							<span class="arrow"><span>&gt;</span></span>
						</span>
					

					
						
							<span class="crust" itemscope="itemscope" itemtype="http://data-vocabulary.org/Breadcrumb">
								<a href="https://oxidemod.org/#oxide-project.1" class="crumb" rel="up" itemprop="url"><span itemprop="title">Oxide Project</span></a>
								<span class="arrow"><span>&gt;</span></span>
							</span>
						
							<span class="crust" itemscope="itemscope" itemtype="http://data-vocabulary.org/Breadcrumb">
								<a href="https://oxidemod.org/categories/archive.104/" class="crumb" rel="up" itemprop="url"><span itemprop="title">Archive</span></a>
								<span class="arrow"><span>&gt;</span></span>
							</span>
						
							<span class="crust" itemscope="itemscope" itemtype="http://data-vocabulary.org/Breadcrumb">
								<a href="https://oxidemod.org/categories/plugin-development.105/" class="crumb" rel="up" itemprop="url"><span itemprop="title">Plugin Development</span></a>
								<span class="arrow"><span>&gt;</span></span>
							</span>
						
							<span class="crust" itemscope="itemscope" itemtype="http://data-vocabulary.org/Breadcrumb">
								<a href="https://oxidemod.org/forums/rust-development.4/" class="crumb" rel="up" itemprop="url"><span itemprop="title">Rust Development</span></a>
								<span class="arrow"><span>&gt;</span></span>
							</span>
						
					
				
			
		</span>
	</fieldset>
</nav>
				</div>
			
			
	
			



			
				

						
			
			
			
						
						
													
								<!-- h1 title, description -->
								<div class="titleBar">
									
									<h1>
										
											
												<span class="prefix prefixGreen">Solved</span> <a href="https://oxidemod.org/threads/make-players-sleep-lua.7435/">Make players sleep? (Lua)</a>
											
										
									</h1>

									<p id="pageDescription" class="muted ">
	Discussion in '<a href="forums/rust-development.4/">Rust Development</a>' started by <a class="username" dir="auto">LaserHydra</a>, <a href="threads/make-players-sleep-lua.7435/"><span class="DateTime" title="Mar 27, 2015 at 9:48 PM">Mar 27, 2015</span></a>.
</p>
								</div>
							
						
						
						
						

						

	

























	




<div class="pageNavLinkGroup">
	<div class="linkGroup SelectionCountContainer">
		
		
	</div>

	


<div class="PageNav"
	data-page="2"
	data-range="2"
	data-start="2"
	data-end="2"
	data-last="2"
	data-sentinel="{{sentinel}}"
	data-baseurl="threads/make-players-sleep-lua.7435/page-{{sentinel}}">
	
	
	<nav>
		
			<a href="threads/make-players-sleep-lua.7435/" class="text">&lt; Prev</a>
			
		
		
		<a href="threads/make-players-sleep-lua.7435/" class="" rel="start">1</a>
		
		
		
		
		
		
		
		<a href="threads/make-players-sleep-lua.7435/page-2" class="currentPage ">2</a>
		
		
	</nav>	
	
	
</div>

</div>






<form action="inline-mod/post/switch" method="post"
	class="InlineModForm section"
	data-cookieName="posts"
	data-controls="#InlineModControls"
	data-imodOptions="#ModerationSelect option">

	<ol class="messageList" id="messageList">
		
			
				


<li id="post-75889" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					okay, can also be my bad when writing it ^^<br />
Thanks<br />
[DOUBLEPOST=1427568568][/DOUBLEPOST]Cant I use rust.SendChatMessage<br />
for that You are now AFK and stuff?<br />
Also where can i add this You arent AFK anymore?
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75889" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 6:48 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75889" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75889/permalink">#21</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75890" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=75889#post-75889" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">okay, can also be my bad when writing it ^^<br />
Thanks<br />
[DOUBLEPOST=1427568568][/DOUBLEPOST]Cant I use rust.SendChatMessage<br />
for that You are now AFK and stuff?<br />
Also where can i add this You arent AFK anymore?</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>You can do that yes, and for the message when a player wakes up you do that in the OnRunCommand hook after it checked that the command that was run is wakeup and after it checked if the player was afk (don&#039;t want to send players the message when they login <img src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie2" alt=";)" title="Wink    ;)" />)
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75890" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 7:00 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75890" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75890/permalink">#22</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75906" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					How do I set the right person? so if I wanna give out: Player isn&#039;t AFK anymore!<br />
I cant set that Player with the player.displayName variable, can I?
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75906" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 8:20 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75906" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75906/permalink">#23</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75909" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=75906#post-75906" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">How do I set the right person? so if I wanna give out: Player isn&#039;t AFK anymore!<br />
I cant set that Player with the player.displayName variable, can I?</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>Ah you want to broadcast, you&#039;ll need to use a different function to broadcast it to everyone and yes at that point you can use player.displayName to display the name.<br />
<br />
rust.BroadcastChat(&quot;AFK&quot;, player.displayName .. &quot; is no longer afk!&quot;)
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75909" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 8:37 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75909" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75909/permalink">#24</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75916" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					that works but it does not work with waking up. I thing the reason is because, also if I am using wakeup in the ingame console, it does not work...<br />
So I think that does not work like that anymore.
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75916" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 9:15 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75916" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75916/permalink">#25</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75919" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=75916#post-75916" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">that works but it does not work with waking up. I thing the reason is because, also if I am using wakeup in the ingame console, it does not work...<br />
So I think that does not work like that anymore.</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>Where did you put it?
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75919" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 9:29 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75919" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75919/permalink">#26</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75922" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeCode">
	<div class="type">Code:</div>
	<pre>
PLUGIN.Title        = &quot;AFK&quot;
PLUGIN.Description  = &quot;AFK System&quot;
PLUGIN.Author       = &quot;LaserHydra&quot;
PLUGIN.Version      = V(1,0,0)
PLUGIN.HasConfig    = true

local afkplayers = {}

local afkcheckinterval = 30
local timeUntilAfk = 600
local timeUntilDisconnect = 1200
local afktimers = {}
local afkbypassadmin = true
local afkchecks = {}

function PLUGIN:Init()
    command.AddChatCommand(&quot;afk&quot;, self.Object, &quot;cmdAfk&quot;)
    command.AddChatCommand(&quot;afklist&quot;, self.Object, &quot;cmdAfkList&quot;)
   
    self:LoadDefaultConfig()
   
    local itPlayerList = global.BasePlayer.activePlayerList:GetEnumerator()
    while itPlayerList:MoveNext() do
        local player = itPlayerList.Current
        self:OnPlayerInit(player)
    end
end
       
function PLUGIN:LoadDefaultConfig()
    self.Config.AfkListMsg = self.Config.AfkListMsg or &quot;Currently AFK:&quot;
    self.Config.NotAllowedMsg = self.Config.NotAllowedMsg or &quot;You are not allowed to use this command.&quot;
    self.Config.PlayerAfkMsg = self.Config.PlayerAfkMsg or &quot;is now AFK!&quot;
    self.Config.PlayerAfkPrivateMsg = self.Config.PlayerAfkPrivateMsg or &quot;You are now AFK!&quot;
    self:SaveConfig()
end
       
function PLUGIN:cmdAfk(player)
    self:SetAfk(player)
end

function PLUGIN:OnPlayerInit(player)
    if afkbypassadmins then
        if player.net.connection.authLevel &gt; 0 then return end
    end
   
    local steamid = rust.UserIDFromPlayer(player)
   
    afktimers[steamid] = timer.Repeat(afkcheckinterval, 0, function() self:AfkCheck(player) end, self.Plugin)
end

function OnPlayerDisconnected(player)
    local steamid = rust.UserIDFromPlayer(player)
    if afktimers[steamid] then
        afktimers[steamid]:Destroy()
    end
end

function PLUGIN:AfkCheck(player)
    local steamid = rust.UserIDFromPlayer(player)
    local position = player.transform.position
   
    if afkchecks[steamid] then
        if afkchecks[steamid].x ~= position.x or afkchecks[steamidk].y ~= position.y or afkchecks[steamid].z ~= position.z then
            if afkchecks[steamid].counter then
                afkchecks[steamid].counter = 1
            else
                afkchecks[steamid].counter = afkchecks[steamid].counter + 1
            end
           
            if afkchecks[steamid].counter &gt;= (timeUntilAfk / afkcheckinterval) then   
                self:SetAfk(player)
            end
           
            if afkchecks[steamid].counter &gt;= (timeUntilDisconnect / afkcheckinterval) then
                self:Disconnect(player)
            end
        else
            afkchecks[steamid] = { x = position.x, y = position.y, z = position.z }
            afkchecks[steamid].counter = 0
        end
    else
        afkchecks[steamid] = { x = position.x, y = position.y, z = position.z }
    end
end

function PLUGIN:SetAfk(player)
    local steamid = rust.UserIDFromPlayer(player)
    afkplayers[steamid] = player.displayName
    self:SendMessage(player, &quot;AFK&quot; .. self.Config.PlayerAfkPrivateMsg)
    player:StartSleeping()
end

function PLUGIN:OnRunCommand( arg )
    if not arg then return end
    if not arg.cmd then return end
    if not arg.cmd.name then return end
    if not arg.connection then return end
    if not arg.connection.player then return end
   
    if arg.cmd.name == &quot;wakeup&quot; then
        local steamid = rust.UserIDFromPlayer(arg.connection.player)
        if afkplayers[steamid] then
            afkplayers[steamid] = nil
            self:EndAfk(player)
        end
    end
end

function PLUGIN:SendMessage(target, message)
    if not target then return end
    if not target:IsConnected() then return end
    message = UnityEngine.StringExtensions.QuoteSafe( message )
    --target:SendConsoleCommand( &quot;chat.add \&quot;&quot; .. &quot;AFK &quot; .. &quot;\&quot;&quot; .. message )
    rust.BroadcastChat(&quot;AFK&quot;, &quot;&quot; .. target.displayName .. &quot; is now AFK!&quot;)
end

function PLUGIN:EndAfk(player)
rust.BroadcastChat(&quot;AFK&quot;, player.displayName .. &quot; is no longer AFK!&quot;)
end
</pre>
</div>
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75922" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 10:01 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75922" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75922/permalink">#27</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75942" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					This will fix the timer problem, just noticed with all the changes that were made that the wakeup command is no longer used so a hook would need to be added to check if a player wakes up so you can&#039;t check that for now actually.<br />


<div class="bbCodeBlock bbCodeCode">
	<div class="type">Code:</div>
	<pre>

PLUGIN.Title        = &quot;AFK&quot;
PLUGIN.Description  = &quot;AFK System&quot;
PLUGIN.Author       = &quot;LaserHydra&quot;
PLUGIN.Version      = V(1,0,0)
PLUGIN.HasConfig    = true

local afkplayers = {}
local afkcheckinterval = 30
local timeUntilAfk = 600
local timeUntilDisconnect = 1200
local afktimers = {}
local afkbypassadmin = true
local afkchecks = {}

function PLUGIN:Init()
    command.AddChatCommand(&quot;afk&quot;, self.Object, &quot;cmdAfk&quot;)
    command.AddChatCommand(&quot;afklist&quot;, self.Object, &quot;cmdAfkList&quot;)
   
    self:LoadDefaultConfig()
   
    local itPlayerList = global.BasePlayer.activePlayerList:GetEnumerator()
    while itPlayerList:MoveNext() do
        local player = itPlayerList.Current
        self:OnPlayerInit(player)
    end
end
       
function PLUGIN:LoadDefaultConfig()
    self.Config.AfkListMsg = self.Config.AfkListMsg or &quot;Currently AFK:&quot;
    self.Config.NotAllowedMsg = self.Config.NotAllowedMsg or &quot;You are not allowed to use this command.&quot;
    self.Config.PlayerAfkMsg = self.Config.PlayerAfkMsg or &quot;is now AFK!&quot;
    self.Config.PlayerAfkPrivateMsg = self.Config.PlayerAfkPrivateMsg or &quot;You are now AFK!&quot;
    self:SaveConfig()
end
       
function PLUGIN:cmdAfk(player)
    self:SetAfk(player)
end

function PLUGIN:OnPlayerInit(player)
    if afkbypassadmins then
        if player.net.connection.authLevel &gt; 0 then return end
    end
   
    local steamid = rust.UserIDFromPlayer(player)
   
    afktimers[steamid] = timer.Repeat(afkcheckinterval, 0, function() self:AfkCheck(player) end, self.Plugin)
end

function OnPlayerDisconnected(player)
    local steamid = rust.UserIDFromPlayer(player)
    if afktimers[steamid] then
        afktimers[steamid]:Destroy()
    end
end

function PLUGIN:AfkCheck(player)
    local steamid = rust.UserIDFromPlayer(player)
    local position = player.transform.position
   
    if afkchecks[steamid] and afkchecks[steamid].x and afkchecks[steamid].y and afkchecks[steamid].z then
        if afkchecks[steamid].x == position.x or afkchecks[steamidk].y == position.y or afkchecks[steamid].z == position.z then
            if not afkchecks[steamid].counter then
                afkchecks[steamid].counter = 1
            else
                afkchecks[steamid].counter = afkchecks[steamid].counter + 1
            end
           
            if afkchecks[steamid].counter &gt;= (timeUntilAfk / afkcheckinterval) then  
                self:SetAfk(player)
            end
           
            if afkchecks[steamid].counter &gt;= (timeUntilDisconnect / afkcheckinterval) then
                self:Disconnect(player)
            end
        else
            afkchecks[steamid] = { x = position.x, y = position.y, z = position.z }
            afkchecks[steamid].counter = 0
        end
    else
        afkchecks[steamid] = { x = position.x, y = position.y, z = position.z }
    end
    print(&quot;Timer ticked&quot;)
end

function PLUGIN:SetAfk(player)
    local steamid = rust.UserIDFromPlayer(player)
    afkplayers[steamid] = player.displayName
    self:SendMessage(player, &quot;AFK &quot; .. self.Config.PlayerAfkPrivateMsg)
    rust.BroadcastChat(&quot;AFK&quot;,  player.displayName .. &quot; is now AFK!&quot;)
    player:StartSleeping()
end

function PLUGIN:SendMessage(target, message)
    if not target then return end
    if not target:IsConnected() then return end
    message = UnityEngine.StringExtensions.QuoteSafe( message )
    target:SendConsoleCommand( &quot;chat.add \&quot;&quot; .. &quot;AFK &quot; .. &quot;\&quot;&quot; .. message )
end

function PLUGIN:EndAfk(player)
    rust.BroadcastChat(&quot;AFK&quot;, player.displayName .. &quot; is no longer AFK!&quot;)
end</pre>
</div>
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75942" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 11:05 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75942" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75942/permalink">#28</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75955" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					So there is no possibility to call that &quot;Player is no longer AFK!&quot; message?
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75955" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 11:39 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75955" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75955/permalink">#29</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75957" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=75955#post-75955" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">So there is no possibility to call that &quot;Player is no longer AFK!&quot; message?</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>You could alter the afk check so that the player moves again and the counter is reset to 0 that the message is displayed at that point but this could result in a delay up to 30 seconds if the interval timer is set to 30.<br />
<br />
Ideally a C# plugin would be used using the OnPlayerInput hook though.
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75957" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 11:42 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75957" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75957/permalink">#30</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75958" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					can&#039;t I set the interval below 30?
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75958" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 28, 2015 at 11:44 PM">Mar 28, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75958" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75958/permalink">#31</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75977" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=75958#post-75958" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">can&#039;t I set the interval below 30?</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>You can yes
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75977" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 29, 2015 at 12:22 AM">Mar 29, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75977" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75977/permalink">#32</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75981" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					So if I set it 5 it wont be a problem
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75981" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 29, 2015 at 12:24 AM">Mar 29, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75981" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75981/permalink">#33</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75984" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=75981#post-75981" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">So if I set it 5 it wont be a problem</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>It would reduce the delay but the timers would run frequently and imagine this on a server with 100 players, so that&#039;s 100 timers that tick every 5 seconds, I&#039;m not sure how it will perform when doing that, haven&#039;t really run anything with that many timers in Lua recently.
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75984" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 29, 2015 at 12:28 AM">Mar 29, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75984" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75984/permalink">#34</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75985" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					What would you do in my place?
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75985" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 29, 2015 at 12:30 AM">Mar 29, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75985" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75985/permalink">#35</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75987" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					Settle for a shorter interval but not too short, 15 perhaps with the intention to rewrite the plugin eventually to C# to use actual player input to check if a player is afk instead of checking the position on interval and comparing it to the last.
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75987" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 29, 2015 at 12:39 AM">Mar 29, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75987" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75987/permalink">#36</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-75988" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					Yeah the problem is, that I even know less of C# ^^<br />
I would need to start up again from zero...<br />
[DOUBLEPOST=1427593220][/DOUBLEPOST]how do I check if he moves again? XD I didn&#039;t understand the whole movement thingy...<br />
<br />
<br />
<br />
<br />
[DOUBLEPOST=1427671443,1427589731][/DOUBLEPOST]<br />
Wulf just added the OnPlayerSleepEnded() Hook :3<br />


<div class="bbCodeBlock bbCodeCode">
	<div class="type">Code:</div>
	<pre>
function PLUGIN:OnPlayerSleepEnded( arg, player )
    local steamid = rust.UserIDFromPlayer(arg.connection.player)
    if afkplayers[steamid] then
        rust.BroadcastChat(&quot;AFK&quot;, player.displayName .. &quot; is no longer AFK!&quot;)
    afkplayers[steamid] = nil
    end
end
</pre>
</div>Doesn&#039;t work like this tho<br />
[DOUBLEPOST=1427671672][/DOUBLEPOST]Well.... The fukin problem could be that I didnt update yet XXDDDD
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-75988" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 30, 2015 at 12:24 AM">Mar 30, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-75988" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/75988/permalink">#37</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-76228" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=75988#post-75988" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">Yeah the problem is, that I even know less of C# ^^<br />
I would need to start up again from zero...<br />
[DOUBLEPOST=1427593220][/DOUBLEPOST]how do I check if he moves again? XD I didn&#039;t understand the whole movement thingy...<br />
<br />
<br />
<br />
<br />
[DOUBLEPOST=1427671443,1427589731][/DOUBLEPOST]<br />
Wulf just added the OnPlayerSleepEnded() Hook :3<br />


<div class="bbCodeBlock bbCodeCode">
	<div class="type">Code:</div>
	<pre>
function PLUGIN:OnPlayerSleepEnded( arg, player )
    local steamid = rust.UserIDFromPlayer(arg.connection.player)
    if afkplayers[steamid] then
        rust.BroadcastChat(&quot;AFK&quot;, player.displayName .. &quot; is no longer AFK!&quot;)
    afkplayers[steamid] = nil
    end
end
</pre>
</div>Doesn&#039;t work like this tho<br />
[DOUBLEPOST=1427671672][/DOUBLEPOST]Well.... The fukin problem could be that I didnt update yet XXDDDD</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>I still need to add the hook to the documentation but the hook works perfectly as I tested it before adding it <img src="styles/default/xenforo/clear.png" class="mceSmilieSprite mceSmilie7" alt=":p" title="Stick Out Tongue    :p" /><br />
The hook only takes one argument, the player.<br />


<div class="bbCodeBlock bbCodeCode">
	<div class="type">Code:</div>
	<pre>OnPlayerSleepEnded(player)</pre>
</div>Also you need to make sure you have the latest oxide installed
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-76228" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 30, 2015 at 6:14 AM">Mar 30, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-76228" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/76228/permalink">#38</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-76250" class="message   " data-author="LaserHydra">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="LaserHydra" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">LaserHydra</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					The rest is correct, isn&#039;t it?
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">LaserHydra</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-76250" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 30, 2015 at 9:20 AM">Mar 30, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-76250" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/76250/permalink">#39</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
			
				


<li id="post-76255" class="message   " data-author="Mughisi">

	

<div class="messageUserInfo" itemscope="itemscope" itemtype="http://data-vocabulary.org/Person">	
<div class="messageUserBlock ">
	
		<div class="avatarHolder">
			<span class="helper"></span>
			<a class="avatar Avm" data-avatarhtml="true"><img src="styles/default/xenforo/avatars/avatar_m.png" width="96" height="96" alt="Mughisi" /></a>
			
			
		</div>
	


	
		<h3 class="userText">
			<a class="username" dir="auto">Mughisi</a>
			
			
		</h3>
	
		
	
		


	<span class="arrow"><span></span></span>
</div>
</div>

	<div class="messageInfo primaryContent">
		
		
		
		
		
		<div class="messageContent">		
			<article>
				<blockquote class="messageText SelectQuoteContainer ugc baseHtml">
					
					<div class="bbCodeBlock bbCodeQuote" data-author="LaserHydra">
	<aside>
		
			<div class="attribution type">LaserHydra said:
				
					<a href="goto/post?id=76250#post-76250" class="AttributionLink">&uarr;</a>
				
			</div>
		
		<blockquote class="quoteContainer"><div class="quote">The rest is correct, isn&#039;t it?</div><div class="quoteExpand">Click to expand...</div></blockquote>
	</aside>
</div>Mostly, you&#039;ll just have to modify the parameter of on the function where you get the steamid:<br />
rust.UserIDFromPlayer(arg.connection.player)<br />
to<br />
rust.UserIDFromPlayer(player)<br />
Then it should work yes.
					<div class="messageTextEndMarker">&nbsp;</div>
				</blockquote>
			</article>
			
			
		</div>
		
		
		
		
		
		
		
				
		<div class="messageMeta ToggleTriggerAnchor">
			
			<div class="privateControls">
				
				<span class="item muted">
					<span class="authorEnd"><a class="username author" dir="auto">Mughisi</a>,</span>
					<a href="threads/make-players-sleep-lua.7435/page-2#post-76255" title="Permalink" class="datePermalink"><span class="DateTime" title="Mar 30, 2015 at 10:42 AM">Mar 30, 2015</span></a>
				</span>
				
				
				
				
				
				
				
				
				
				
				
			</div>
			
			<div class="publicControls">
				<a href="threads/make-players-sleep-lua.7435/page-2#post-76255" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/76255/permalink">#40</a>
				
				
				
				
			</div>
		</div>
	</div>

	
	
	
	
</li>
			
		
		
	</ol>

	

	

</form>


	<div class="pageNavLinkGroup">
		
			
				<div class="linkGroup">
					
				</div>
			
			<div class="linkGroup" style="display: none"><a href="javascript:" class="muted JsOnly DisplayIgnoredContent Tooltip" title="Show hidden content by ">Show Ignored Content</a></div>

			


<div class="PageNav"
	data-page="2"
	data-range="2"
	data-start="2"
	data-end="2"
	data-last="2"
	data-sentinel="{{sentinel}}"
	data-baseurl="threads/make-players-sleep-lua.7435/page-{{sentinel}}">
	
	
	<nav>
		
			<a href="threads/make-players-sleep-lua.7435/" class="text">&lt; Prev</a>
			
		
		
		<a href="threads/make-players-sleep-lua.7435/" class="" rel="start">1</a>
		
		
		
		
		
		
		
		<a href="threads/make-players-sleep-lua.7435/page-2" class="currentPage ">2</a>
		
		
	</nav>	
	
	
</div>

		
	</div>












	


												
												
					
			
						
			
						
			


			<footer>
				


<div class="footer">
		<div class="pageContent">
			
            
            
            </div>
			
		
			
			
			<span class="helper"></span>
			<ul class="footerLinks">
			
				
				<li><a href="https://oxidemod.org/terms/">Terms and Rules</a></li>
				
				
				<li><a href="https://umod.org/community" target="_blank">Contact Us</a></li>
			
			</ul>
			
			<span class="helper"></span>
		</div>
</div>

			</footer>
		</div>
	</div>
</div>

<header>
	


<div id="header">
	<div class="headerWidth">
		<div id="logoBlock">
			
			
			<div id="logo"><a href="https://oxidemod.org/">
				<span></span>
				<img src="styles/oxide/logo.png" alt="Oxide" />
			</a></div>
			
			
			<span class="helper"></span>

</div>
		


<div id="navigation" class="">
	<div class="pageContent">
		<nav>
			<div class="navTabs">
				<ul class="publicTabs">

					
					

					
					

					
					
						<li class="navTab forums Popup PopupControl PopupClosed PopupContainerControl">
							<a href="https://oxidemod.org/" class="navLink" rel="Menu">Forums</a>

							
						</li>
					

					<li class="navTab PopupClosed">
	<a href="https://umod.org/documentation" class="navLink">Docs</a>
</li>


					
					
						
							<li class="navTab Popup PopupControl PopupClosed PopupContainerControl">

							<a href="https://oxidemod.org/downloads/" class="navLink" rel="Menu"> Downloads </a>

							
						</li>
						
					
						
							<li class="navTab Popup PopupControl PopupClosed PopupContainerControl">

							<a href="https://oxidemod.org/plugins/" class="navLink" rel="Menu"> Plugins </a>

							
						</li>
						
					
					

					
					

					
					

					
					<li class="navTab selected"><div class="tabLinks"></div></li>
				</ul>

				
				
			</div>

			<span class="helper"></span>
		</nav>
	</div>
</div>
	</div>
</div>

	
	
</header>

</div>

<script>


jQuery.extend(true, XenForo,
{
	visitor: { user_id: 0 },
	serverTimeInfo:
	{
		now: 1548533151,
		today: 1548460800,
		todayDow: 6
	},
	_lightBoxUniversal: "0",
	_enableOverlays: "1",
	_animationSpeedMultiplier: "1",
	_overlayConfig:
	{
		top: "10%",
		speed: 200,
		closeSpeed: 100,
		mask:
		{
			color: "rgb(255, 255, 255)",
			opacity: "0.6",
			loadSpeed: 200,
			closeSpeed: 100
		}
	},
	_ignoredUsers: [],
	_loadedScripts: {"thread_view":true,"message":true,"bb_code":true,"message_user_info":true},
	_cookieConfig: { path: "/", domain: ".oxidemod.org", prefix: "ih_xfid_"},
	_csrfToken: "",
	_csrfRefreshUrl: "login/csrf-token-refresh",
	_jsVersion: "f33b43a2"
});
jQuery.extend(XenForo.phrases,
{
	cancel: "Cancel",

	a_moment_ago:    "A moment ago",
	one_minute_ago:  "1 minute ago",
	x_minutes_ago:   "%minutes% minutes ago",
	today_at_x:      "Today at %time%",
	yesterday_at_x:  "Yesterday at %time%",
	day_x_at_time_y: "%day% at %time%",

	day0: "Sunday",
	day1: "Monday",
	day2: "Tuesday",
	day3: "Wednesday",
	day4: "Thursday",
	day5: "Friday",
	day6: "Saturday",

	_months: "January,February,March,April,May,June,July,August,September,October,November,December",
	_daysShort: "Sun,Mon,Tue,Wed,Thu,Fri,Sat",

	following_error_occurred: "The following error occurred",
	server_did_not_respond_in_time_try_again: "The server did not respond in time. Please try again.",
	logging_in: "Logging in",
	click_image_show_full_size_version: "Click this image to show the full-size version.",
	show_hidden_content_by_x: "Show hidden content by {names}"
});




</script>




</body>
</html>